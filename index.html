<html>
  <head>
	<title>going rogue</title>
	<!--<link rel="stylesheet" href="static/css/reset.css">-->
	<link rel="stylesheet" href="static/css/grogue.css">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Brawler">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="static/scripts/gridmangler.js"></script>
	<script type="text/javascript" src="static/scripts/eyeofthetiler.js"></script>
	<script type="text/javascript" src="static/scripts/tilecodes.js"></script>
	<script type="text/javascript" src="static/scripts/gameutils.js"></script>		
	<script type="text/javascript" src="static/scripts/gameobjects.js"></script>
	<script type="text/javascript" src="static/scripts/levelgen.js"></script>
	<script type="text/javascript" src="static/scripts/fov.js"></script>
	<script type="text/javascript" src="static/scripts/game_ai.js"></script>
	<script type="text/javascript" src="static/scripts/grogue.js"></script>

  <script type="text/javascript">
	var game;

  $(document).ready(function ( ) {
	var imageFiles = [constants.tiles_image];

  /////////////////////////////////////////////////////////
  // Helper function, used below.
  // Usage: ['img1.jpg','img2.jpg'].remove('img1.jpg');
  Array.prototype.remove = function(element) {
	for (var i = 0; i < this.length; i++) {
	  if (this[i] == element) { this.splice(i,1); }
	}
  };

  // Usage: $(['img1.jpg','img2.jpg']).preloadImages(function(){ ... });
  // Callback function gets called after all images are preloaded
  $.fn.preloadImages = function(callback) {
	checklist = this.toArray();
	var img;
	this.each(function() {
	  img = $('<img />').attr({ src: this, id: this });
	  $('#id_div_preload').append(img);
	  img.load(function() {
		checklist.remove($(this).attr('src'));
		if (checklist.length == 0) { callback(); }
	  });
	});
  };
  ////////////////////////////////////////////////////////////

  $(document).keydown(
	function (e) {
	  game.keypress(e);
	}
  );

  $(imageFiles).preloadImages(initGame);
  });

  var initGame = function ( ) {
	var tilecodes = getTileCodes();
	game = grogue($, tilecodes, level_generator());
	game.init();
  };
</script>
</head>

  <body>
	<h1 class="game_header">welcome to my underground lair</h1>
	<div id="id_div_container">
	  <table>
		<tr>
		  <td>
			<canvas id="id_cnv_game" width="360" height="416" >
			  arg!
			</canvas>
		  </td>
		  <td>
			<table padding="0px">
			  <tr>
				<td>
				  <canvas id="id_cnv_playerinfo" width="192" height="160" >
					hey
				  </canvas>
				</td>
			  </tr>
			  <tr>
				<td>
				  <canvas id="id_cnv_equip" width="192" height="96" >
					arg!
				  </canvas>
				</td>
			  </tr>
			  <tr>
				<td>
				  <canvas id="id_cnv_inventory" width="192" height="64" >
					arg!
				  </canvas>
				</td>
			  </tr>
			  <tr>
				<td>
				  <canvas id="id_cnv_monsterinfo" width="192" height="90" >
					arg!
				  </canvas>
				</td>
			  </tr>
			</table>
		  </td>
		</tr>
	  </table>

	  <div id="id_div_click"></div>
	  <div id="id_div_hover"></div>
	</div>
  
	<div id="id_div_preload" style="display: none">
	</div>
  </body>
</html>